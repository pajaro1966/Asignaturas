
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Transliterador de Griego</title>
  <style>
    body { font-family: sans-serif; padding: 2em; }
    textarea { width: 100%; height: 150px; margin-bottom: 1em; font-size: 1.2em; }
    button { margin: 0.5em 1em 0.5em 0; padding: 0.5em 1em; }
    #output { border: 1px solid #ccc; padding: 1em; white-space: pre-wrap; min-height: 150px; margin-bottom: 1em; }
    .no-trans { color: red; font-size: 120%; }
  </style>
</head>
<body>
  <h1>Transliterador de Griego</h1>
  <label for="input">Texto en griego:</label>
  <textarea id="input" placeholder="Escribe aquí tu texto en griego..."></textarea>

  <div>
    <button onclick="convertir('antiguo')">Griego Antiguo → Latino</button>
    <button onclick="convertir('moderno')">Griego Moderno → Latino</button>
    <button onclick="copiarResultado()">Copiar resultado</button>
  </div>

  <h2>Resultado:</h2>
  <div id="output"></div>

  <script>
    let tablas = {};

    async function cargarTabla(nombre) {
      const resp = await fetch(nombre);
      const texto = await resp.text();
      const mapa = new Map();
      texto.split('\n').forEach(linea => {
        const [griego, latino] = linea.split('\t');
        if (griego && latino) {
          mapa.set(griego, latino);
          mapa.set(griego.toUpperCase(), latino.toUpperCase());
        }
      });
      return mapa;
    }

    window.onload = async () => {
      tablas.antiguo = await cargarTabla('translit_antiguo_COMPLETO.txt');
      tablas.moderno = await cargarTabla('translit_moderno_COMPLETO.txt');
    };

    function convertir(tipo) {
      let texto = document.getElementById('input').value;
      const mapa = tablas[tipo];
      let resultado = '';
      let i = 0;

      while (i < texto.length) {
        let convertido = null;
        for (let len = 3; len > 0; len--) {
          const segmento = texto.slice(i, i + len);
          if (mapa.has(segmento)) {
            convertido = mapa.get(segmento);
            i += len;
            break;
          }
        }
        if (convertido === null) {
          resultado += `<span class="no-trans">${texto[i]}</span>`;
          i++;
        } else {
          resultado += convertido;
        }
      }

      document.getElementById('output').innerHTML = resultado;
    }

    function copiarResultado() {
      const contenedor = document.getElementById('output');
      const temp = document.createElement('textarea');
      temp.value = contenedor.innerText;
      document.body.appendChild(temp);
      temp.select();
      document.execCommand('copy');
      document.body.removeChild(temp);
      alert("Resultado copiado al portapapeles");
    }
  </script>
</body>
</html>
